# 1st pipeline

name: Smallscreen-pipeline

on:
 push:
    branches: [ "feature-DEV" ]


jobs:
    build:
      runs-on: self-hosted

      steps:
       
        - name: MAHI-GIT-CHECKOUT
          uses: actions/checkout@v4

        - name: JAVA INSTALLING
          uses: actions/setup-java@v4
          with:
            java-version: '17'
            distribution: 'temurin'

            # here mvn package --file pom.xml we can include
        - name: BUILD WITH MAVEN
          run: |
            mvn package 
            
        - name: Uploading ARTIFACTS TO REPO
          uses: actions/upload-artifact@v4
          with:
            name: FirstTRYY-artifact
            path: target/*.jar


        - name: TRIVY SCAN FOR VUL
          run: |
            trivy fs . --format table -o trivy-fs-report.html

        - name: Install Required toolfor sonar
          run: |
            sudo apt-get update
            sudo apt-get install -y unzip curl

        - name: SONAR-SCAN
          uses: sonarsource/sonarqube-scan-action@v7
          env:
            SONAR_TOKEN: ${{ secrets.SONAR_TOKEN }}
            SONAR_HOST_URL: ${{ secrets.SONAR_HOST_URL }}

        - name: Install jq
          run: sudo apt-get update && sudo apt-get install -y jq


        - name: Sonar-gate-check
          id: sonarqube-quality-gate-check
          uses: sonarsource/sonarqube-quality-gate-action@v7
          timeout-minutes: 5
          env:
            SONAR_TOKEN: ${{ secrets.SONAR_TOKEN }}
            SONAR_HOST_URL: ${{ secrets.SONAR_HOST_URL }}
            
          
          
          

        
     
        

         
            

        

        
        
